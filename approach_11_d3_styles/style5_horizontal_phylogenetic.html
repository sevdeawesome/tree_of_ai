<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Evolution - Phylogenetic Tree (1958-2025)</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
        body {
            margin: 0;
            padding: 40px;
            font-family: 'Palatino Linotype', 'Book Antiqua', Palatino, serif;
            background: linear-gradient(to bottom, #f8f9fa 0%, #e9ecef 100%);
            overflow-x: auto;
        }

        #container {
            min-width: 3000px;
            position: relative;
        }

        svg {
            display: block;
        }

        .timeline-line {
            stroke: #dee2e6;
            stroke-width: 2;
            stroke-dasharray: 5,5;
        }

        .timeline-label {
            font-size: 14px;
            fill: #6c757d;
            font-weight: 600;
            text-anchor: middle;
        }

        .branch {
            fill: none;
            stroke-width: 2.5;
            stroke-linecap: round;
            stroke-linejoin: round;
            opacity: 0.8;
            transition: opacity 0.3s, stroke-width 0.3s;
        }

        .branch:hover {
            opacity: 1;
            stroke-width: 4;
        }

        .branch.extinct {
            opacity: 0.3;
            stroke-dasharray: 4,4;
        }

        .node circle {
            cursor: pointer;
            transition: all 0.3s;
        }

        .node circle:hover {
            filter: drop-shadow(0 0 12px currentColor);
            r: 8;
        }

        .node.extinct circle {
            opacity: 0.4;
        }

        .label {
            font-size: 11px;
            fill: #212529;
            pointer-events: none;
            text-shadow: 0 0 3px white, 0 0 5px white;
        }

        .label.important {
            font-size: 13px;
            font-weight: 700;
        }

        .label.extinct {
            opacity: 0.5;
            font-style: italic;
        }

        .title-group {
            font-family: 'Georgia', serif;
        }

        .main-title {
            font-size: 42px;
            font-weight: 300;
            fill: #212529;
            letter-spacing: 2px;
        }

        .subtitle {
            font-size: 18px;
            fill: #6c757d;
            font-style: italic;
        }

        .legend-group {
            font-size: 12px;
        }

        .legend-label {
            fill: #495057;
        }

        .extinction-band {
            fill: rgba(220, 53, 69, 0.1);
            stroke: rgba(220, 53, 69, 0.3);
            stroke-width: 1;
            stroke-dasharray: 3,3;
        }

        .extinction-label {
            font-size: 10px;
            fill: #dc3545;
            font-style: italic;
        }

        .breakthrough-marker {
            font-size: 20px;
            text-anchor: middle;
            pointer-events: none;
        }

        .info-panel {
            position: fixed;
            top: 40px;
            right: 40px;
            background: rgba(255, 255, 255, 0.95);
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            max-width: 300px;
            font-size: 12px;
            border: 1px solid #dee2e6;
        }

        .info-title {
            font-size: 14px;
            font-weight: bold;
            margin-bottom: 10px;
            color: #495057;
        }

        .controls {
            position: fixed;
            bottom: 40px;
            right: 40px;
            background: rgba(255, 255, 255, 0.95);
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            border: 1px solid #dee2e6;
        }

        .controls button {
            display: block;
            width: 100%;
            margin: 5px 0;
            padding: 8px 12px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 11px;
            transition: background 0.3s;
        }

        .controls button:hover {
            background: #0056b3;
        }
    </style>
</head>
<body>
    <div class="info-panel">
        <div class="info-title">The Phylogenetic Tree of AI</div>
        <p>A chronological visualization of artificial intelligence evolution from the Perceptron (1958) to modern AGI systems (2025).</p>
        <p><strong>How to read:</strong></p>
        <ul style="margin: 10px 0; padding-left: 20px;">
            <li>Time flows left â†’ right</li>
            <li>Branches show lineage</li>
            <li>Colors indicate AI families</li>
            <li>Bold = high importance</li>
            <li>Dashed = extinct lineages</li>
        </ul>
    </div>

    <div class="controls">
        <button onclick="toggleExtinct()">Toggle Extinct Models</button>
        <button onclick="highlightFamily('transformer')">Highlight Transformers</button>
        <button onclick="highlightFamily('all')">Show All</button>
        <button onclick="exportSVG()">Export SVG</button>
    </div>

    <div id="container"></div>

    <script>
        // All 114 AI models with complete relationships
        const models = [
            {"name": "Perceptron", "parent": null, "year": 1958, "color": "#2F4F4F", "importance": 5, "branch_type": "root", "extinct": false},
            {"name": "Symbolic AI", "parent": "Perceptron", "year": 1960, "color": "#8B7355", "importance": 3, "branch_type": "symbolic", "extinct": true},
            {"name": "ELIZA", "parent": "Symbolic AI", "year": 1966, "color": "#8B7355", "importance": 2, "branch_type": "symbolic", "extinct": true},
            {"name": "Expert Systems", "parent": "Symbolic AI", "year": 1975, "color": "#8B7355", "importance": 2, "branch_type": "symbolic", "extinct": true},
            {"name": "Backpropagation", "parent": "Perceptron", "year": 1986, "color": "#FF6347", "importance": 5, "branch_type": "innovation", "extinct": false},
            {"name": "Neocognitron", "parent": "Perceptron", "year": 1980, "color": "#DDA0DD", "importance": 2, "branch_type": "cnn", "extinct": true},
            {"name": "CNNs", "parent": "Backpropagation", "year": 1989, "color": "#9370DB", "importance": 4, "branch_type": "cnn", "extinct": false},
            {"name": "LeNet-1", "parent": "CNNs", "year": 1989, "color": "#9370DB", "importance": 2, "branch_type": "cnn", "extinct": false},
            {"name": "LeNet-5", "parent": "LeNet-1", "year": 1998, "color": "#9370DB", "importance": 3, "branch_type": "cnn", "extinct": false},
            {"name": "AlexNet", "parent": "LeNet-5", "year": 2012, "color": "#9370DB", "importance": 5, "branch_type": "cnn", "extinct": false},
            {"name": "VGGNet", "parent": "AlexNet", "year": 2014, "color": "#9370DB", "importance": 3, "branch_type": "cnn", "extinct": false},
            {"name": "GoogLeNet", "parent": "AlexNet", "year": 2014, "color": "#9370DB", "importance": 3, "branch_type": "cnn", "extinct": false},
            {"name": "ResNet", "parent": "AlexNet", "year": 2015, "color": "#9370DB", "importance": 5, "branch_type": "cnn", "extinct": false},
            {"name": "EfficientNet", "parent": "ResNet", "year": 2019, "color": "#9370DB", "importance": 3, "branch_type": "cnn", "extinct": false},
            {"name": "RNNs", "parent": "Backpropagation", "year": 1990, "color": "#4169E1", "importance": 3, "branch_type": "rnn", "extinct": true},
            {"name": "LSTM", "parent": "RNNs", "year": 1997, "color": "#4169E1", "importance": 4, "branch_type": "rnn", "extinct": true},
            {"name": "GRU", "parent": "LSTM", "year": 2014, "color": "#4169E1", "importance": 2, "branch_type": "rnn", "extinct": true},
            {"name": "Seq2Seq", "parent": "LSTM", "year": 2014, "color": "#4169E1", "importance": 3, "branch_type": "rnn", "extinct": true},
            {"name": "Word2Vec", "parent": "RNNs", "year": 2013, "color": "#87CEEB", "importance": 3, "branch_type": "embedding", "extinct": false},
            {"name": "GloVe", "parent": "Word2Vec", "year": 2014, "color": "#87CEEB", "importance": 2, "branch_type": "embedding", "extinct": false},
            {"name": "GANs", "parent": "Backpropagation", "year": 2014, "color": "#FFA500", "importance": 4, "branch_type": "gan", "extinct": true},
            {"name": "Progressive GAN", "parent": "GANs", "year": 2017, "color": "#FFA500", "importance": 2, "branch_type": "gan", "extinct": true},
            {"name": "StyleGAN", "parent": "Progressive GAN", "year": 2018, "color": "#FFA500", "importance": 3, "branch_type": "gan", "extinct": true},
            {"name": "StyleGAN2", "parent": "StyleGAN", "year": 2019, "color": "#FFA500", "importance": 3, "branch_type": "gan", "extinct": true},
            {"name": "BigGAN", "parent": "GANs", "year": 2018, "color": "#FFA500", "importance": 2, "branch_type": "gan", "extinct": true},
            {"name": "Q-Learning", "parent": "Perceptron", "year": 1989, "color": "#228B22", "importance": 3, "branch_type": "rl", "extinct": false},
            {"name": "DQN", "parent": "Q-Learning", "year": 2013, "color": "#228B22", "importance": 3, "branch_type": "rl", "extinct": false},
            {"name": "AlphaGo", "parent": "DQN", "year": 2016, "color": "#228B22", "importance": 5, "branch_type": "rl", "extinct": false},
            {"name": "AlphaGo Zero", "parent": "AlphaGo", "year": 2017, "color": "#228B22", "importance": 4, "branch_type": "rl", "extinct": false},
            {"name": "PPO", "parent": "DQN", "year": 2017, "color": "#228B22", "importance": 3, "branch_type": "rl", "extinct": false},
            {"name": "RLHF", "parent": "PPO", "year": 2020, "color": "#228B22", "importance": 4, "branch_type": "rl", "extinct": false},
            {"name": "Transformers", "parent": "Backpropagation", "year": 2017, "color": "#00CED1", "importance": 5, "branch_type": "transformer", "extinct": false},
            {"name": "BERT", "parent": "Transformers", "year": 2018, "color": "#8B008B", "importance": 5, "branch_type": "encoder", "extinct": false},
            {"name": "RoBERTa", "parent": "BERT", "year": 2019, "color": "#8B008B", "importance": 3, "branch_type": "encoder", "extinct": false},
            {"name": "ALBERT", "parent": "BERT", "year": 2019, "color": "#8B008B", "importance": 2, "branch_type": "encoder", "extinct": false},
            {"name": "DistilBERT", "parent": "BERT", "year": 2019, "color": "#8B008B", "importance": 2, "branch_type": "encoder", "extinct": false},
            {"name": "ELECTRA", "parent": "BERT", "year": 2020, "color": "#8B008B", "importance": 2, "branch_type": "encoder", "extinct": false},
            {"name": "ModernBERT", "parent": "BERT", "year": 2024, "color": "#8B008B", "importance": 2, "branch_type": "encoder", "extinct": false},
            {"name": "GPT", "parent": "Transformers", "year": 2018, "color": "#00BFFF", "importance": 4, "branch_type": "decoder", "extinct": false},
            {"name": "GPT-2", "parent": "GPT", "year": 2019, "color": "#00BFFF", "importance": 4, "branch_type": "decoder", "extinct": false},
            {"name": "GPT-3", "parent": "GPT-2", "year": 2020, "color": "#00BFFF", "importance": 5, "branch_type": "decoder", "extinct": false},
            {"name": "GPT-3.5", "parent": "GPT-3", "year": 2022, "color": "#00BFFF", "importance": 4, "branch_type": "decoder", "extinct": false},
            {"name": "ChatGPT", "parent": "GPT-3.5", "year": 2022, "color": "#00BFFF", "importance": 5, "branch_type": "decoder", "extinct": false},
            {"name": "GPT-4", "parent": "ChatGPT", "year": 2023, "color": "#00BFFF", "importance": 5, "branch_type": "decoder", "extinct": false},
            {"name": "GPT-4 Turbo", "parent": "GPT-4", "year": 2023, "color": "#00BFFF", "importance": 3, "branch_type": "decoder", "extinct": false},
            {"name": "GPT-4o", "parent": "GPT-4 Turbo", "year": 2024, "color": "#00BFFF", "importance": 4, "branch_type": "decoder", "extinct": false},
            {"name": "o1", "parent": "GPT-4o", "year": 2024, "color": "#00BFFF", "importance": 5, "branch_type": "decoder", "extinct": false},
            {"name": "Claude", "parent": "Transformers", "year": 2023, "color": "#7B68EE", "importance": 4, "branch_type": "claude", "extinct": false},
            {"name": "Claude 2", "parent": "Claude", "year": 2023, "color": "#7B68EE", "importance": 3, "branch_type": "claude", "extinct": false},
            {"name": "Claude 3 Haiku", "parent": "Claude 2", "year": 2024, "color": "#7B68EE", "importance": 3, "branch_type": "claude", "extinct": false},
            {"name": "Claude 3 Sonnet", "parent": "Claude 2", "year": 2024, "color": "#7B68EE", "importance": 4, "branch_type": "claude", "extinct": false},
            {"name": "Claude 3 Opus", "parent": "Claude 2", "year": 2024, "color": "#7B68EE", "importance": 4, "branch_type": "claude", "extinct": false},
            {"name": "Claude 3.5 Sonnet", "parent": "Claude 3 Sonnet", "year": 2024, "color": "#7B68EE", "importance": 5, "branch_type": "claude", "extinct": false},
            {"name": "Claude 4 Sonnet", "parent": "Claude 3.5 Sonnet", "year": 2025, "color": "#7B68EE", "importance": 5, "branch_type": "claude", "extinct": false},
            {"name": "PaLM", "parent": "Transformers", "year": 2022, "color": "#008B8B", "importance": 4, "branch_type": "google", "extinct": false},
            {"name": "PaLM 2", "parent": "PaLM", "year": 2023, "color": "#008B8B", "importance": 4, "branch_type": "google", "extinct": false},
            {"name": "Gemini 1.0", "parent": "PaLM 2", "year": 2023, "color": "#008B8B", "importance": 4, "branch_type": "google", "extinct": false},
            {"name": "Gemini 1.5", "parent": "Gemini 1.0", "year": 2024, "color": "#008B8B", "importance": 4, "branch_type": "google", "extinct": false},
            {"name": "Gemini 2.0", "parent": "Gemini 1.5", "year": 2024, "color": "#008B8B", "importance": 4, "branch_type": "google", "extinct": false},
            {"name": "Gemini 2.5", "parent": "Gemini 2.0", "year": 2025, "color": "#008B8B", "importance": 4, "branch_type": "google", "extinct": false},
            {"name": "Gemma", "parent": "PaLM", "year": 2024, "color": "#20B2AA", "importance": 3, "branch_type": "google", "extinct": false},
            {"name": "Gemma 2", "parent": "Gemma", "year": 2024, "color": "#20B2AA", "importance": 3, "branch_type": "google", "extinct": false},
            {"name": "LLaMA", "parent": "Transformers", "year": 2023, "color": "#FF4500", "importance": 5, "branch_type": "llama", "extinct": false},
            {"name": "LLaMA 2", "parent": "LLaMA", "year": 2023, "color": "#FF4500", "importance": 4, "branch_type": "llama", "extinct": false},
            {"name": "LLaMA 3", "parent": "LLaMA 2", "year": 2024, "color": "#FF4500", "importance": 5, "branch_type": "llama", "extinct": false},
            {"name": "LLaMA 3.1", "parent": "LLaMA 3", "year": 2024, "color": "#FF4500", "importance": 4, "branch_type": "llama", "extinct": false},
            {"name": "LLaMA 3.2", "parent": "LLaMA 3.1", "year": 2024, "color": "#FF4500", "importance": 3, "branch_type": "llama", "extinct": false},
            {"name": "LLaMA 4", "parent": "LLaMA 3.2", "year": 2025, "color": "#FF4500", "importance": 4, "branch_type": "llama", "extinct": false},
            {"name": "Code Llama", "parent": "LLaMA", "year": 2023, "color": "#FF6347", "importance": 3, "branch_type": "llama", "extinct": false},
            {"name": "Phi-1", "parent": "Transformers", "year": 2023, "color": "#C0C0C0", "importance": 2, "branch_type": "microsoft", "extinct": false},
            {"name": "Phi-2", "parent": "Phi-1", "year": 2023, "color": "#C0C0C0", "importance": 3, "branch_type": "microsoft", "extinct": false},
            {"name": "Phi-3", "parent": "Phi-2", "year": 2024, "color": "#C0C0C0", "importance": 3, "branch_type": "microsoft", "extinct": false},
            {"name": "Phi-4", "parent": "Phi-3", "year": 2025, "color": "#C0C0C0", "importance": 3, "branch_type": "microsoft", "extinct": false},
            {"name": "Command", "parent": "Transformers", "year": 2023, "color": "#CD7F32", "importance": 3, "branch_type": "cohere", "extinct": false},
            {"name": "Command R", "parent": "Command", "year": 2024, "color": "#CD7F32", "importance": 3, "branch_type": "cohere", "extinct": false},
            {"name": "Command R+", "parent": "Command R", "year": 2024, "color": "#CD7F32", "importance": 3, "branch_type": "cohere", "extinct": false},
            {"name": "T5", "parent": "Transformers", "year": 2019, "color": "#9ACD32", "importance": 4, "branch_type": "enc-dec", "extinct": false},
            {"name": "BART", "parent": "Transformers", "year": 2019, "color": "#9ACD32", "importance": 3, "branch_type": "enc-dec", "extinct": false},
            {"name": "FLAN-T5", "parent": "T5", "year": 2022, "color": "#9ACD32", "importance": 3, "branch_type": "enc-dec", "extinct": false},
            {"name": "CLIP", "parent": "Transformers", "year": 2021, "color": "#DA70D6", "importance": 4, "branch_type": "multimodal", "extinct": false},
            {"name": "DALL-E", "parent": "CLIP", "year": 2021, "color": "#DA70D6", "importance": 4, "branch_type": "multimodal", "extinct": false},
            {"name": "Flamingo", "parent": "CLIP", "year": 2022, "color": "#DA70D6", "importance": 3, "branch_type": "multimodal", "extinct": false},
            {"name": "GPT-4V", "parent": "GPT-4", "year": 2023, "color": "#DA70D6", "importance": 4, "branch_type": "multimodal", "extinct": false},
            {"name": "ViT", "parent": "Transformers", "year": 2020, "color": "#BA55D3", "importance": 4, "branch_type": "vit", "extinct": false},
            {"name": "DeiT", "parent": "ViT", "year": 2020, "color": "#BA55D3", "importance": 2, "branch_type": "vit", "extinct": false},
            {"name": "Swin Transformer", "parent": "ViT", "year": 2021, "color": "#BA55D3", "importance": 3, "branch_type": "vit", "extinct": false},
            {"name": "BEiT", "parent": "ViT", "year": 2021, "color": "#BA55D3", "importance": 2, "branch_type": "vit", "extinct": false},
            {"name": "DDPM", "parent": "Backpropagation", "year": 2020, "color": "#FF1493", "importance": 4, "branch_type": "diffusion", "extinct": false},
            {"name": "DALL-E 2", "parent": "DDPM", "year": 2022, "color": "#FF1493", "importance": 5, "branch_type": "diffusion", "extinct": false},
            {"name": "Stable Diffusion", "parent": "DDPM", "year": 2022, "color": "#FF1493", "importance": 5, "branch_type": "diffusion", "extinct": false},
            {"name": "SD 2.x", "parent": "Stable Diffusion", "year": 2022, "color": "#FF1493", "importance": 3, "branch_type": "diffusion", "extinct": false},
            {"name": "SDXL", "parent": "SD 2.x", "year": 2023, "color": "#FF1493", "importance": 4, "branch_type": "diffusion", "extinct": false},
            {"name": "Midjourney", "parent": "DDPM", "year": 2022, "color": "#FF69B4", "importance": 5, "branch_type": "diffusion", "extinct": false},
            {"name": "SD 3", "parent": "SDXL", "year": 2024, "color": "#FF1493", "importance": 4, "branch_type": "diffusion", "extinct": false},
            {"name": "SD 3.5", "parent": "SD 3", "year": 2024, "color": "#FF1493", "importance": 3, "branch_type": "diffusion", "extinct": false},
            {"name": "Imagen 3", "parent": "DDPM", "year": 2024, "color": "#FF1493", "importance": 3, "branch_type": "diffusion", "extinct": false},
            {"name": "Qwen", "parent": "Transformers", "year": 2023, "color": "#DC143C", "importance": 4, "branch_type": "chinese", "extinct": false},
            {"name": "Qwen-2", "parent": "Qwen", "year": 2024, "color": "#DC143C", "importance": 4, "branch_type": "chinese", "extinct": false},
            {"name": "Qwen-2.5", "parent": "Qwen-2", "year": 2024, "color": "#DC143C", "importance": 4, "branch_type": "chinese", "extinct": false},
            {"name": "Qwen-2.5-Max", "parent": "Qwen-2.5", "year": 2025, "color": "#DC143C", "importance": 4, "branch_type": "chinese", "extinct": false},
            {"name": "ERNIE", "parent": "Transformers", "year": 2019, "color": "#FFD700", "importance": 3, "branch_type": "chinese", "extinct": false},
            {"name": "ERNIE 3.0", "parent": "ERNIE", "year": 2021, "color": "#FFD700", "importance": 3, "branch_type": "chinese", "extinct": false},
            {"name": "ERNIE Bot", "parent": "ERNIE 3.0", "year": 2023, "color": "#FFD700", "importance": 3, "branch_type": "chinese", "extinct": false},
            {"name": "ERNIE 4.0", "parent": "ERNIE Bot", "year": 2023, "color": "#FFD700", "importance": 3, "branch_type": "chinese", "extinct": false},
            {"name": "Doubao", "parent": "Transformers", "year": 2024, "color": "#FF8C00", "importance": 3, "branch_type": "chinese", "extinct": false},
            {"name": "Doubao-1.5-Pro", "parent": "Doubao", "year": 2025, "color": "#FF8C00", "importance": 3, "branch_type": "chinese", "extinct": false},
            {"name": "ChatGLM", "parent": "Transformers", "year": 2023, "color": "#B22222", "importance": 3, "branch_type": "chinese", "extinct": false},
            {"name": "GLM-4", "parent": "ChatGLM", "year": 2024, "color": "#B22222", "importance": 3, "branch_type": "chinese", "extinct": false},
            {"name": "Yi", "parent": "Transformers", "year": 2023, "color": "#8B0000", "importance": 3, "branch_type": "chinese", "extinct": false},
            {"name": "Yi-VL", "parent": "Yi", "year": 2024, "color": "#8B0000", "importance": 3, "branch_type": "chinese", "extinct": false},
            {"name": "DeepSeek", "parent": "Transformers", "year": 2023, "color": "#800000", "importance": 4, "branch_type": "chinese", "extinct": false},
            {"name": "DeepSeek-V2", "parent": "DeepSeek", "year": 2024, "color": "#800000", "importance": 4, "branch_type": "chinese", "extinct": false},
            {"name": "DeepSeek-R1", "parent": "DeepSeek-V2", "year": 2025, "color": "#800000", "importance": 5, "branch_type": "chinese", "extinct": false},
            {"name": "Kimi", "parent": "Transformers", "year": 2023, "color": "#CD5C5C", "importance": 3, "branch_type": "chinese", "extinct": false}
        ];

        // Canvas dimensions
        const width = 3000;
        const height = 2400;
        const margin = {top: 120, right: 200, bottom: 80, left: 100};

        // Create SVG
        const svg = d3.select("#container")
            .append("svg")
            .attr("width", width)
            .attr("height", height);

        const g = svg.append("g")
            .attr("transform", `translate(${margin.left},${margin.top})`);

        // Time scale (1958-2025)
        const xScale = d3.scaleLinear()
            .domain([1958, 2025])
            .range([0, width - margin.left - margin.right]);

        // Build tree structure
        const nodeMap = new Map();
        models.forEach(m => {
            nodeMap.set(m.name, {...m, children: []});
        });

        models.forEach(m => {
            if (m.parent) {
                const parent = nodeMap.get(m.parent);
                if (parent) {
                    parent.children.push(nodeMap.get(m.name));
                }
            }
        });

        const root = nodeMap.get("Perceptron");

        // Calculate vertical positions using tree layout algorithm
        function calculatePositions(node, y = 0, yMin = 0, yMax = height - margin.top - margin.bottom) {
            node.x = xScale(node.year);

            if (node.children.length === 0) {
                node.y = (yMin + yMax) / 2;
            } else {
                const childHeight = (yMax - yMin) / node.children.length;
                node.children.forEach((child, i) => {
                    calculatePositions(child, y + 1, yMin + i * childHeight, yMin + (i + 1) * childHeight);
                });
                // Parent positioned at average of children
                node.y = d3.mean(node.children, d => d.y);
            }
        }

        calculatePositions(root);

        // Collect all nodes
        const allNodes = [];
        function collectNodes(node) {
            allNodes.push(node);
            node.children.forEach(collectNodes);
        }
        collectNodes(root);

        // Draw title
        const titleGroup = svg.append("g")
            .attr("class", "title-group")
            .attr("transform", `translate(${width/2}, 50)`);

        titleGroup.append("text")
            .attr("class", "main-title")
            .attr("text-anchor", "middle")
            .text("The Phylogenetic Tree of Artificial Intelligence");

        titleGroup.append("text")
            .attr("class", "subtitle")
            .attr("text-anchor", "middle")
            .attr("y", 32)
            .text("Evolution from Perceptron to AGI â€¢ 1958â€”2025");

        // Draw timeline markers
        const timelineYears = [1960, 1970, 1980, 1990, 2000, 2010, 2015, 2020, 2025];
        const timelineGroup = g.append("g").attr("class", "timeline");

        timelineGroup.selectAll("line")
            .data(timelineYears)
            .join("line")
            .attr("class", "timeline-line")
            .attr("x1", d => xScale(d))
            .attr("x2", d => xScale(d))
            .attr("y1", 0)
            .attr("y2", height - margin.top - margin.bottom);

        timelineGroup.selectAll("text")
            .data(timelineYears)
            .join("text")
            .attr("class", "timeline-label")
            .attr("x", d => xScale(d))
            .attr("y", -15)
            .text(d => d);

        // Draw branches (curved paths)
        const branchGroup = g.append("g").attr("class", "branches");

        allNodes.forEach(node => {
            node.children.forEach(child => {
                const path = d3.path();
                path.moveTo(node.x, node.y);

                // Bezier curve for organic look
                const midX = (node.x + child.x) / 2;
                path.bezierCurveTo(
                    midX, node.y,
                    midX, child.y,
                    child.x, child.y
                );

                branchGroup.append("path")
                    .attr("d", path.toString())
                    .attr("class", child.extinct ? "branch extinct" : "branch")
                    .attr("stroke", child.color)
                    .attr("stroke-width", child.importance * 1.5)
                    .attr("data-family", child.branch_type);
            });
        });

        // Draw nodes
        const nodeGroup = g.append("g").attr("class", "nodes");

        const nodeElements = nodeGroup.selectAll("g")
            .data(allNodes)
            .join("g")
            .attr("class", d => d.extinct ? "node extinct" : "node")
            .attr("transform", d => `translate(${d.x},${d.y})`)
            .attr("data-family", d => d.branch_type);

        nodeElements.append("circle")
            .attr("r", d => d.importance * 1.5 + 2)
            .attr("fill", d => d.color)
            .attr("stroke", "#fff")
            .attr("stroke-width", 1.5);

        // Add labels (smart positioning to avoid overlaps)
        const labelGroup = g.append("g").attr("class", "labels");

        allNodes.forEach(node => {
            // Only label important nodes or key models
            if (node.importance >= 4 || ["Perceptron", "Backpropagation", "Transformers", "ChatGPT", "DeepSeek-R1"].includes(node.name)) {
                const labelOffset = node.children.length > 0 ? -12 : 12;
                const anchor = node.children.length > 0 ? "end" : "start";

                labelGroup.append("text")
                    .attr("class", node.extinct ? "label extinct" : (node.importance >= 5 ? "label important" : "label"))
                    .attr("x", node.x + labelOffset)
                    .attr("y", node.y + 4)
                    .attr("text-anchor", anchor)
                    .text(node.name);
            }
        });

        // Add breakthrough markers
        const breakthroughs = [
            {name: "Backpropagation", year: 1986, marker: "â­"},
            {name: "AlexNet", year: 2012, marker: "ðŸ’¥"},
            {name: "Transformers", year: 2017, marker: "ðŸ’¥"},
            {name: "GPT-3", year: 2020, marker: "â­"},
            {name: "ChatGPT", year: 2022, marker: "ðŸ’¥"},
            {name: "DeepSeek-R1", year: 2025, marker: "ðŸ’¥"}
        ];

        breakthroughs.forEach(bt => {
            const node = allNodes.find(n => n.name === bt.name);
            if (node) {
                g.append("text")
                    .attr("class", "breakthrough-marker")
                    .attr("x", node.x)
                    .attr("y", node.y - 18)
                    .text(bt.marker);
            }
        });

        // Add legend
        const legendData = [
            {label: "CNNs", color: "#9370DB"},
            {label: "RNNs (extinct)", color: "#4169E1"},
            {label: "Transformers", color: "#00CED1"},
            {label: "GPT", color: "#00BFFF"},
            {label: "Claude", color: "#7B68EE"},
            {label: "LLaMA", color: "#FF4500"},
            {label: "Gemini", color: "#008B8B"},
            {label: "Chinese AI", color: "#DC143C"},
            {label: "Diffusion", color: "#FF1493"},
            {label: "RL", color: "#228B22"}
        ];

        const legend = svg.append("g")
            .attr("class", "legend-group")
            .attr("transform", `translate(${width - margin.right + 20}, ${margin.top})`);

        legend.selectAll("g")
            .data(legendData)
            .join("g")
            .attr("transform", (d, i) => `translate(0, ${i * 25})`)
            .each(function(d) {
                d3.select(this).append("line")
                    .attr("x1", 0)
                    .attr("x2", 30)
                    .attr("stroke", d.color)
                    .attr("stroke-width", 3);

                d3.select(this).append("text")
                    .attr("class", "legend-label")
                    .attr("x", 40)
                    .attr("y", 4)
                    .text(d.label);
            });

        // Interactive controls
        let extinctVisible = true;

        function toggleExtinct() {
            extinctVisible = !extinctVisible;
            d3.selectAll(".extinct").style("opacity", extinctVisible ? null : 0);
        }

        function highlightFamily(family) {
            if (family === 'all') {
                d3.selectAll(".branch").style("opacity", null);
                d3.selectAll(".node circle").style("opacity", null);
            } else {
                d3.selectAll(".branch").style("opacity", 0.1);
                d3.selectAll(".node circle").style("opacity", 0.1);
                d3.selectAll(`[data-family="${family}"]`).style("opacity", 1);
            }
        }

        function exportSVG() {
            const svgData = document.querySelector("svg").outerHTML;
            const blob = new Blob([svgData], {type: "image/svg+xml"});
            const url = URL.createObjectURL(blob);
            const link = document.createElement("a");
            link.href = url;
            link.download = "ai_phylogenetic_tree.svg";
            link.click();
        }
    </script>
</body>
</html>
